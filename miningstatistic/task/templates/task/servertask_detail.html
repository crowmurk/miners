{% extends "task/base_task.html" %}

{% block title %}
    {{ block.super }} - {{ servertask }}
{% endblock %}

{% block content %}
    <article>
        <div class="row">
            <div class="offset-by-two eight columns">
                <h3>Задание #{{ servertask.id }}</h3>
                <ul class="inline">
                    <li><a href="{{ servertask.get_update_url }}" class="button">Изменить задание</a></li>
                    <li><a href="{{ servertask.get_delete_url }}" class="button">Удалить задание</a></li>
                </ul>
                <dl>
                    <qdt><strong>Активно:</strong></dt>
                    {% if servertask.enabled %}
                        <dd>Да</dd>
                    {% else %}
                        <dd>Нет</dd>
                    {% endif %}
                    <qdt><strong>Последний запуск:</strong></dt>
                    {% if servertask.executed %}
                        <dd>{{ servertask.executed }}</dd>
                    {% else %}
                        <dd>Никогда</dd>
                    {% endif %}
                    <qdt><strong>Результат</strong></dt>
                    {% if servertask.status %}
                        <dd>Успех</dd>
                    {% else %}
                        {% if servertask.status is False %}
                            <dd>Ошибка</dd>
                        {% else %}
                            <dd>Неизвестен</dd>
                        {% endif %}
                    {% endif %}
                </dl>
                <h5>Параметры задания:</h5>
                <dl>
                    <dt><strong>Сервер:</strong></dt>
                    <dd><a href="{{ servertask.server.get_absolute_url }}">{{ servertask.server.name }}</a></dd>
                    <dt><strong>Майнер:</strong></dt>
                    <dd><a href="{{ servertask.server.miner.get_absolute_url }}">{{ servertask.server.miner }}</a></dd>
                    <dt><strong>Запросы:</strong></dt>
                    {% for request in servertask.requests.all %}
                        <dd><a href="{{ request.get_absolute_url }}">{{ request.name }}</a></dd>
                    {% empty %}
                        <li><em>Запросы отсутствуют.</em></li>
                    {% endfor %}
                    {% if servertask.timeout %}
                        <dt><strong>Таймаут:</strong></dt>
                        <dd>{{ servertask.timeout }}</dd>
                    {% endif %}
                </dl>
            </div>
        </div>
    </article>
{% endblock %}
